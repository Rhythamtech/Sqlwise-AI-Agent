[
  {
    "id": "logic_net_revenue_last_30_days",
    "text": "What is the total net revenue for the last 30 days?",
    "pseudo_sql": "SELECT SUM(oi.priceusd - COALESCE(r.refund, 0)) FROM orderitems oi LEFT JOIN (SELECT orderitemid, SUM(refundamountusd) as refund FROM refunds GROUP BY 1) r ON oi.orderitemid = r.orderitemid",
    "metadata": {
      "topic": "finance",
      "subtopic": "revenue",
      "logic_id": "net_revenue",
      "variant": 1
    }
  },
  {
    "id": "logic_net_revenue_monthly_2025",
    "text": "Show me net revenue broken down by month for 2025.",
    "pseudo_sql": "SELECT SUM(oi.priceusd - COALESCE(r.refund, 0)) FROM orderitems oi LEFT JOIN (SELECT orderitemid, SUM(refundamountusd) as refund FROM refunds GROUP BY 1) r ON oi.orderitemid = r.orderitemid",
    "metadata": {
      "topic": "finance",
      "subtopic": "revenue",
      "logic_id": "net_revenue",
      "variant": 2
    }
  },
  {
    "id": "logic_net_revenue_by_category",
    "text": "Which product category has the highest net revenue?",
    "pseudo_sql": "SELECT SUM(oi.priceusd - COALESCE(r.refund, 0)) FROM orderitems oi LEFT JOIN (SELECT orderitemid, SUM(refundamountusd) as refund FROM refunds GROUP BY 1) r ON oi.orderitemid = r.orderitemid",
    "metadata": {
      "topic": "finance",
      "subtopic": "revenue",
      "logic_id": "net_revenue",
      "variant": 3
    }
  },
  {
    "id": "logic_net_revenue_wow_comparison",
    "text": "What was the net revenue for yesterday compared to the same day last week?",
    "pseudo_sql": "SELECT SUM(oi.priceusd - COALESCE(r.refund, 0)) FROM orderitems oi LEFT JOIN (SELECT orderitemid, SUM(refundamountusd) as refund FROM refunds GROUP BY 1) r ON oi.orderitemid = r.orderitemid",
    "metadata": {
      "topic": "finance",
      "subtopic": "revenue",
      "logic_id": "net_revenue",
      "variant": 4
    }
  },
  {
    "id": "logic_net_revenue_top_5_ytd",
    "text": "Show top 5 net revenue contributors for the current year.",
    "pseudo_sql": "SELECT SUM(oi.priceusd - COALESCE(r.refund, 0)) FROM orderitems oi LEFT JOIN (SELECT orderitemid, SUM(refundamountusd) as refund FROM refunds GROUP BY 1) r ON oi.orderitemid = r.orderitemid",
    "metadata": {
      "topic": "finance",
      "subtopic": "revenue",
      "logic_id": "net_revenue",
      "variant": 5
    }
  },
  {
    "id": "logic_gross_revenue_last_30_days",
    "text": "What is the total gross revenue for the last 30 days?",
    "pseudo_sql": "SELECT SUM(priceusd) FROM orderitems",
    "metadata": {
      "topic": "finance",
      "subtopic": "revenue",
      "logic_id": "gross_revenue",
      "variant": 1
    }
  },
  {
    "id": "logic_gross_revenue_monthly_2025",
    "text": "Show me gross revenue broken down by month for 2025.",
    "pseudo_sql": "SELECT SUM(priceusd) FROM orderitems",
    "metadata": {
      "topic": "finance",
      "subtopic": "revenue",
      "logic_id": "gross_revenue",
      "variant": 2
    }
  },
  {
    "id": "logic_gross_revenue_by_category",
    "text": "Which product category has the highest gross revenue?",
    "pseudo_sql": "SELECT SUM(priceusd) FROM orderitems",
    "metadata": {
      "topic": "finance",
      "subtopic": "revenue",
      "logic_id": "gross_revenue",
      "variant": 3
    }
  },
  {
    "id": "logic_gross_revenue_wow_comparison",
    "text": "What was the gross revenue for yesterday compared to the same day last week?",
    "pseudo_sql": "SELECT SUM(priceusd) FROM orderitems",
    "metadata": {
      "topic": "finance",
      "subtopic": "revenue",
      "logic_id": "gross_revenue",
      "variant": 4
    }
  },
  {
    "id": "logic_gross_revenue_top_5_ytd",
    "text": "Show top 5 gross revenue contributors for the current year.",
    "pseudo_sql": "SELECT SUM(priceusd) FROM orderitems",
    "metadata": {
      "topic": "finance",
      "subtopic": "revenue",
      "logic_id": "gross_revenue",
      "variant": 5
    }
  },
  {
    "id": "logic_gross_profit_last_30_days",
    "text": "What is the total gross profit for the last 30 days?",
    "pseudo_sql": "SELECT SUM(oi.priceusd - COALESCE(r.refund, 0) - oi.cogsusd) FROM orderitems oi LEFT JOIN (SELECT orderitemid, SUM(refundamountusd) as refund FROM refunds GROUP BY 1) r ON oi.orderitemid = r.orderitemid",
    "metadata": {
      "topic": "finance",
      "subtopic": "profit",
      "logic_id": "gross_profit",
      "variant": 1
    }
  },
  {
    "id": "logic_gross_profit_monthly_2025",
    "text": "Show me gross profit broken down by month for 2025.",
    "pseudo_sql": "SELECT SUM(oi.priceusd - COALESCE(r.refund, 0) - oi.cogsusd) FROM orderitems oi LEFT JOIN (SELECT orderitemid, SUM(refundamountusd) as refund FROM refunds GROUP BY 1) r ON oi.orderitemid = r.orderitemid",
    "metadata": {
      "topic": "finance",
      "subtopic": "profit",
      "logic_id": "gross_profit",
      "variant": 2
    }
  },
  {
    "id": "logic_gross_profit_by_category",
    "text": "Which product category has the highest gross profit?",
    "pseudo_sql": "SELECT SUM(oi.priceusd - COALESCE(r.refund, 0) - oi.cogsusd) FROM orderitems oi LEFT JOIN (SELECT orderitemid, SUM(refundamountusd) as refund FROM refunds GROUP BY 1) r ON oi.orderitemid = r.orderitemid",
    "metadata": {
      "topic": "finance",
      "subtopic": "profit",
      "logic_id": "gross_profit",
      "variant": 3
    }
  },
  {
    "id": "logic_gross_profit_wow_comparison",
    "text": "What was the gross profit for yesterday compared to the same day last week?",
    "pseudo_sql": "SELECT SUM(oi.priceusd - COALESCE(r.refund, 0) - oi.cogsusd) FROM orderitems oi LEFT JOIN (SELECT orderitemid, SUM(refundamountusd) as refund FROM refunds GROUP BY 1) r ON oi.orderitemid = r.orderitemid",
    "metadata": {
      "topic": "finance",
      "subtopic": "profit",
      "logic_id": "gross_profit",
      "variant": 4
    }
  },
  {
    "id": "logic_gross_profit_top_5_ytd",
    "text": "Show top 5 gross profit contributors for the current year.",
    "pseudo_sql": "SELECT SUM(oi.priceusd - COALESCE(r.refund, 0) - oi.cogsusd) FROM orderitems oi LEFT JOIN (SELECT orderitemid, SUM(refundamountusd) as refund FROM refunds GROUP BY 1) r ON oi.orderitemid = r.orderitemid",
    "metadata": {
      "topic": "finance",
      "subtopic": "profit",
      "logic_id": "gross_profit",
      "variant": 5
    }
  },
  {
    "id": "logic_cogs_last_30_days",
    "text": "What is the total cogs for the last 30 days?",
    "pseudo_sql": "SELECT SUM(oi.priceusd - COALESCE(r.refund, 0) - oi.cogsusd) FROM orderitems oi LEFT JOIN (SELECT orderitemid, SUM(refundamountusd) as refund FROM refunds GROUP BY 1) r ON oi.orderitemid = r.orderitemid",
    "metadata": {
      "topic": "finance",
      "subtopic": "profit",
      "logic_id": "cogs",
      "variant": 1
    }
  },
  {
    "id": "logic_cogs_monthly_2025",
    "text": "Show me cogs broken down by month for 2025.",
    "pseudo_sql": "SELECT SUM(oi.priceusd - COALESCE(r.refund, 0) - oi.cogsusd) FROM orderitems oi LEFT JOIN (SELECT orderitemid, SUM(refundamountusd) as refund FROM refunds GROUP BY 1) r ON oi.orderitemid = r.orderitemid",
    "metadata": {
      "topic": "finance",
      "subtopic": "profit",
      "logic_id": "cogs",
      "variant": 2
    }
  },
  {
    "id": "logic_cogs_by_category",
    "text": "Which product category has the highest cogs?",
    "pseudo_sql": "SELECT SUM(oi.priceusd - COALESCE(r.refund, 0) - oi.cogsusd) FROM orderitems oi LEFT JOIN (SELECT orderitemid, SUM(refundamountusd) as refund FROM refunds GROUP BY 1) r ON oi.orderitemid = r.orderitemid",
    "metadata": {
      "topic": "finance",
      "subtopic": "profit",
      "logic_id": "cogs",
      "variant": 3
    }
  },
  {
    "id": "logic_cogs_wow_comparison",
    "text": "What was the cogs for yesterday compared to the same day last week?",
    "pseudo_sql": "SELECT SUM(oi.priceusd - COALESCE(r.refund, 0) - oi.cogsusd) FROM orderitems oi LEFT JOIN (SELECT orderitemid, SUM(refundamountusd) as refund FROM refunds GROUP BY 1) r ON oi.orderitemid = r.orderitemid",
    "metadata": {
      "topic": "finance",
      "subtopic": "profit",
      "logic_id": "cogs",
      "variant": 4
    }
  },
  {
    "id": "logic_cogs_top_5_ytd",
    "text": "Show top 5 cogs contributors for the current year.",
    "pseudo_sql": "SELECT SUM(oi.priceusd - COALESCE(r.refund, 0) - oi.cogsusd) FROM orderitems oi LEFT JOIN (SELECT orderitemid, SUM(refundamountusd) as refund FROM refunds GROUP BY 1) r ON oi.orderitemid = r.orderitemid",
    "metadata": {
      "topic": "finance",
      "subtopic": "profit",
      "logic_id": "cogs",
      "variant": 5
    }
  },
  {
    "id": "logic_currency_usd_last_30_days",
    "text": "What is the total currency usd for the last 30 days?",
    "pseudo_sql": "SELECT COUNT(*) FROM orderitems oi",
    "metadata": {
      "topic": "finance",
      "subtopic": "currency",
      "logic_id": "currency_usd",
      "variant": 1
    }
  },
  {
    "id": "logic_currency_usd_monthly_2025",
    "text": "Show me currency usd broken down by month for 2025.",
    "pseudo_sql": "SELECT COUNT(*) FROM orderitems oi",
    "metadata": {
      "topic": "finance",
      "subtopic": "currency",
      "logic_id": "currency_usd",
      "variant": 2
    }
  },
  {
    "id": "logic_currency_usd_by_category",
    "text": "Which product category has the highest currency usd?",
    "pseudo_sql": "SELECT COUNT(*) FROM orderitems oi",
    "metadata": {
      "topic": "finance",
      "subtopic": "currency",
      "logic_id": "currency_usd",
      "variant": 3
    }
  },
  {
    "id": "logic_currency_usd_wow_comparison",
    "text": "What was the currency usd for yesterday compared to the same day last week?",
    "pseudo_sql": "SELECT COUNT(*) FROM orderitems oi",
    "metadata": {
      "topic": "finance",
      "subtopic": "currency",
      "logic_id": "currency_usd",
      "variant": 4
    }
  },
  {
    "id": "logic_currency_usd_top_5_ytd",
    "text": "Show top 5 currency usd contributors for the current year.",
    "pseudo_sql": "SELECT COUNT(*) FROM orderitems oi",
    "metadata": {
      "topic": "finance",
      "subtopic": "currency",
      "logic_id": "currency_usd",
      "variant": 5
    }
  },
  {
    "id": "logic_last_touch_attribution_last_30_days",
    "text": "What is the total last touch attribution for the last 30 days?",
    "pseudo_sql": "SELECT s.utmsource, SUM(oi.priceusd - COALESCE(r.refund, 0)) FROM sessions s JOIN orders o ON s.sessionid = o.sessionid JOIN orderitems oi ON o.orderid = oi.orderid LEFT JOIN (SELECT orderitemid, SUM(refundamountusd) as refund FROM refunds GROUP BY 1) r ON oi.orderitemid = r.orderitemid",
    "metadata": {
      "topic": "traffic",
      "subtopic": "attribution",
      "logic_id": "last_touch_attribution",
      "variant": 1
    }
  },
  {
    "id": "logic_last_touch_attribution_monthly_2025",
    "text": "Show me last touch attribution broken down by month for 2025.",
    "pseudo_sql": "SELECT s.utmsource, SUM(oi.priceusd - COALESCE(r.refund, 0)) FROM sessions s JOIN orders o ON s.sessionid = o.sessionid JOIN orderitems oi ON o.orderid = oi.orderid LEFT JOIN (SELECT orderitemid, SUM(refundamountusd) as refund FROM refunds GROUP BY 1) r ON oi.orderitemid = r.orderitemid",
    "metadata": {
      "topic": "traffic",
      "subtopic": "attribution",
      "logic_id": "last_touch_attribution",
      "variant": 2
    }
  },
  {
    "id": "logic_last_touch_attribution_by_category",
    "text": "Which product category has the highest last touch attribution?",
    "pseudo_sql": "SELECT s.utmsource, SUM(oi.priceusd - COALESCE(r.refund, 0)) FROM sessions s JOIN orders o ON s.sessionid = o.sessionid JOIN orderitems oi ON o.orderid = oi.orderid LEFT JOIN (SELECT orderitemid, SUM(refundamountusd) as refund FROM refunds GROUP BY 1) r ON oi.orderitemid = r.orderitemid",
    "metadata": {
      "topic": "traffic",
      "subtopic": "attribution",
      "logic_id": "last_touch_attribution",
      "variant": 3
    }
  },
  {
    "id": "logic_last_touch_attribution_wow_comparison",
    "text": "What was the last touch attribution for yesterday compared to the same day last week?",
    "pseudo_sql": "SELECT s.utmsource, SUM(oi.priceusd - COALESCE(r.refund, 0)) FROM sessions s JOIN orders o ON s.sessionid = o.sessionid JOIN orderitems oi ON o.orderid = oi.orderid LEFT JOIN (SELECT orderitemid, SUM(refundamountusd) as refund FROM refunds GROUP BY 1) r ON oi.orderitemid = r.orderitemid",
    "metadata": {
      "topic": "traffic",
      "subtopic": "attribution",
      "logic_id": "last_touch_attribution",
      "variant": 4
    }
  },
  {
    "id": "logic_last_touch_attribution_top_5_ytd",
    "text": "Show top 5 last touch attribution contributors for the current year.",
    "pseudo_sql": "SELECT s.utmsource, SUM(oi.priceusd - COALESCE(r.refund, 0)) FROM sessions s JOIN orders o ON s.sessionid = o.sessionid JOIN orderitems oi ON o.orderid = oi.orderid LEFT JOIN (SELECT orderitemid, SUM(refundamountusd) as refund FROM refunds GROUP BY 1) r ON oi.orderitemid = r.orderitemid",
    "metadata": {
      "topic": "traffic",
      "subtopic": "attribution",
      "logic_id": "last_touch_attribution",
      "variant": 5
    }
  },
  {
    "id": "logic_direct_traffic_last_30_days",
    "text": "What is the total direct traffic for the last 30 days?",
    "pseudo_sql": "SELECT s.utmsource, SUM(oi.priceusd - COALESCE(r.refund, 0)) FROM sessions s JOIN orders o ON s.sessionid = o.sessionid JOIN orderitems oi ON o.orderid = oi.orderid LEFT JOIN (SELECT orderitemid, SUM(refundamountusd) as refund FROM refunds GROUP BY 1) r ON oi.orderitemid = r.orderitemid",
    "metadata": {
      "topic": "traffic",
      "subtopic": "attribution",
      "logic_id": "direct_traffic",
      "variant": 1
    }
  },
  {
    "id": "logic_direct_traffic_monthly_2025",
    "text": "Show me direct traffic broken down by month for 2025.",
    "pseudo_sql": "SELECT s.utmsource, SUM(oi.priceusd - COALESCE(r.refund, 0)) FROM sessions s JOIN orders o ON s.sessionid = o.sessionid JOIN orderitems oi ON o.orderid = oi.orderid LEFT JOIN (SELECT orderitemid, SUM(refundamountusd) as refund FROM refunds GROUP BY 1) r ON oi.orderitemid = r.orderitemid",
    "metadata": {
      "topic": "traffic",
      "subtopic": "attribution",
      "logic_id": "direct_traffic",
      "variant": 2
    }
  },
  {
    "id": "logic_direct_traffic_by_category",
    "text": "Which product category has the highest direct traffic?",
    "pseudo_sql": "SELECT s.utmsource, SUM(oi.priceusd - COALESCE(r.refund, 0)) FROM sessions s JOIN orders o ON s.sessionid = o.sessionid JOIN orderitems oi ON o.orderid = oi.orderid LEFT JOIN (SELECT orderitemid, SUM(refundamountusd) as refund FROM refunds GROUP BY 1) r ON oi.orderitemid = r.orderitemid",
    "metadata": {
      "topic": "traffic",
      "subtopic": "attribution",
      "logic_id": "direct_traffic",
      "variant": 3
    }
  },
  {
    "id": "logic_direct_traffic_wow_comparison",
    "text": "What was the direct traffic for yesterday compared to the same day last week?",
    "pseudo_sql": "SELECT s.utmsource, SUM(oi.priceusd - COALESCE(r.refund, 0)) FROM sessions s JOIN orders o ON s.sessionid = o.sessionid JOIN orderitems oi ON o.orderid = oi.orderid LEFT JOIN (SELECT orderitemid, SUM(refundamountusd) as refund FROM refunds GROUP BY 1) r ON oi.orderitemid = r.orderitemid",
    "metadata": {
      "topic": "traffic",
      "subtopic": "attribution",
      "logic_id": "direct_traffic",
      "variant": 4
    }
  },
  {
    "id": "logic_direct_traffic_top_5_ytd",
    "text": "Show top 5 direct traffic contributors for the current year.",
    "pseudo_sql": "SELECT s.utmsource, SUM(oi.priceusd - COALESCE(r.refund, 0)) FROM sessions s JOIN orders o ON s.sessionid = o.sessionid JOIN orderitems oi ON o.orderid = oi.orderid LEFT JOIN (SELECT orderitemid, SUM(refundamountusd) as refund FROM refunds GROUP BY 1) r ON oi.orderitemid = r.orderitemid",
    "metadata": {
      "topic": "traffic",
      "subtopic": "attribution",
      "logic_id": "direct_traffic",
      "variant": 5
    }
  },
  {
    "id": "logic_organic_referral_last_30_days",
    "text": "What is the total organic referral for the last 30 days?",
    "pseudo_sql": "SELECT s.utmsource, SUM(oi.priceusd - COALESCE(r.refund, 0)) FROM sessions s JOIN orders o ON s.sessionid = o.sessionid JOIN orderitems oi ON o.orderid = oi.orderid LEFT JOIN (SELECT orderitemid, SUM(refundamountusd) as refund FROM refunds GROUP BY 1) r ON oi.orderitemid = r.orderitemid",
    "metadata": {
      "topic": "traffic",
      "subtopic": "attribution",
      "logic_id": "organic_referral",
      "variant": 1
    }
  },
  {
    "id": "logic_organic_referral_monthly_2025",
    "text": "Show me organic referral broken down by month for 2025.",
    "pseudo_sql": "SELECT s.utmsource, SUM(oi.priceusd - COALESCE(r.refund, 0)) FROM sessions s JOIN orders o ON s.sessionid = o.sessionid JOIN orderitems oi ON o.orderid = oi.orderid LEFT JOIN (SELECT orderitemid, SUM(refundamountusd) as refund FROM refunds GROUP BY 1) r ON oi.orderitemid = r.orderitemid",
    "metadata": {
      "topic": "traffic",
      "subtopic": "attribution",
      "logic_id": "organic_referral",
      "variant": 2
    }
  },
  {
    "id": "logic_organic_referral_by_category",
    "text": "Which product category has the highest organic referral?",
    "pseudo_sql": "SELECT s.utmsource, SUM(oi.priceusd - COALESCE(r.refund, 0)) FROM sessions s JOIN orders o ON s.sessionid = o.sessionid JOIN orderitems oi ON o.orderid = oi.orderid LEFT JOIN (SELECT orderitemid, SUM(refundamountusd) as refund FROM refunds GROUP BY 1) r ON oi.orderitemid = r.orderitemid",
    "metadata": {
      "topic": "traffic",
      "subtopic": "attribution",
      "logic_id": "organic_referral",
      "variant": 3
    }
  },
  {
    "id": "logic_organic_referral_wow_comparison",
    "text": "What was the organic referral for yesterday compared to the same day last week?",
    "pseudo_sql": "SELECT s.utmsource, SUM(oi.priceusd - COALESCE(r.refund, 0)) FROM sessions s JOIN orders o ON s.sessionid = o.sessionid JOIN orderitems oi ON o.orderid = oi.orderid LEFT JOIN (SELECT orderitemid, SUM(refundamountusd) as refund FROM refunds GROUP BY 1) r ON oi.orderitemid = r.orderitemid",
    "metadata": {
      "topic": "traffic",
      "subtopic": "attribution",
      "logic_id": "organic_referral",
      "variant": 4
    }
  },
  {
    "id": "logic_organic_referral_top_5_ytd",
    "text": "Show top 5 organic referral contributors for the current year.",
    "pseudo_sql": "SELECT s.utmsource, SUM(oi.priceusd - COALESCE(r.refund, 0)) FROM sessions s JOIN orders o ON s.sessionid = o.sessionid JOIN orderitems oi ON o.orderid = oi.orderid LEFT JOIN (SELECT orderitemid, SUM(refundamountusd) as refund FROM refunds GROUP BY 1) r ON oi.orderitemid = r.orderitemid",
    "metadata": {
      "topic": "traffic",
      "subtopic": "attribution",
      "logic_id": "organic_referral",
      "variant": 5
    }
  },
  {
    "id": "logic_session_conversion_last_30_days",
    "text": "What is the total session conversion for the last 30 days?",
    "pseudo_sql": "SELECT COUNT(DISTINCT o.orderid)::FLOAT / COUNT(DISTINCT s.sessionid) FROM sessions s LEFT JOIN orders o ON s.sessionid = o.sessionid",
    "metadata": {
      "topic": "traffic",
      "subtopic": "conversion",
      "logic_id": "session_conversion",
      "variant": 1
    }
  },
  {
    "id": "logic_session_conversion_monthly_2025",
    "text": "Show me session conversion broken down by month for 2025.",
    "pseudo_sql": "SELECT COUNT(DISTINCT o.orderid)::FLOAT / COUNT(DISTINCT s.sessionid) FROM sessions s LEFT JOIN orders o ON s.sessionid = o.sessionid",
    "metadata": {
      "topic": "traffic",
      "subtopic": "conversion",
      "logic_id": "session_conversion",
      "variant": 2
    }
  },
  {
    "id": "logic_session_conversion_by_category",
    "text": "Which product category has the highest session conversion?",
    "pseudo_sql": "SELECT COUNT(DISTINCT o.orderid)::FLOAT / COUNT(DISTINCT s.sessionid) FROM sessions s LEFT JOIN orders o ON s.sessionid = o.sessionid",
    "metadata": {
      "topic": "traffic",
      "subtopic": "conversion",
      "logic_id": "session_conversion",
      "variant": 3
    }
  },
  {
    "id": "logic_session_conversion_wow_comparison",
    "text": "What was the session conversion for yesterday compared to the same day last week?",
    "pseudo_sql": "SELECT COUNT(DISTINCT o.orderid)::FLOAT / COUNT(DISTINCT s.sessionid) FROM sessions s LEFT JOIN orders o ON s.sessionid = o.sessionid",
    "metadata": {
      "topic": "traffic",
      "subtopic": "conversion",
      "logic_id": "session_conversion",
      "variant": 4
    }
  },
  {
    "id": "logic_session_conversion_top_5_ytd",
    "text": "Show top 5 session conversion contributors for the current year.",
    "pseudo_sql": "SELECT COUNT(DISTINCT o.orderid)::FLOAT / COUNT(DISTINCT s.sessionid) FROM sessions s LEFT JOIN orders o ON s.sessionid = o.sessionid",
    "metadata": {
      "topic": "traffic",
      "subtopic": "conversion",
      "logic_id": "session_conversion",
      "variant": 5
    }
  },
  {
    "id": "logic_active_user_last_30_days",
    "text": "What is the total active user for the last 30 days?",
    "pseudo_sql": "SELECT COUNT(*) FROM orderitems oi",
    "metadata": {
      "topic": "customer",
      "subtopic": "segmentation",
      "logic_id": "active_user",
      "variant": 1
    }
  },
  {
    "id": "logic_active_user_monthly_2025",
    "text": "Show me active user broken down by month for 2025.",
    "pseudo_sql": "SELECT COUNT(*) FROM orderitems oi",
    "metadata": {
      "topic": "customer",
      "subtopic": "segmentation",
      "logic_id": "active_user",
      "variant": 2
    }
  },
  {
    "id": "logic_active_user_by_category",
    "text": "Which product category has the highest active user?",
    "pseudo_sql": "SELECT COUNT(*) FROM orderitems oi",
    "metadata": {
      "topic": "customer",
      "subtopic": "segmentation",
      "logic_id": "active_user",
      "variant": 3
    }
  },
  {
    "id": "logic_active_user_wow_comparison",
    "text": "What was the active user for yesterday compared to the same day last week?",
    "pseudo_sql": "SELECT COUNT(*) FROM orderitems oi",
    "metadata": {
      "topic": "customer",
      "subtopic": "segmentation",
      "logic_id": "active_user",
      "variant": 4
    }
  },
  {
    "id": "logic_active_user_top_5_ytd",
    "text": "Show top 5 active user contributors for the current year.",
    "pseudo_sql": "SELECT COUNT(*) FROM orderitems oi",
    "metadata": {
      "topic": "customer",
      "subtopic": "segmentation",
      "logic_id": "active_user",
      "variant": 5
    }
  },
  {
    "id": "logic_repeat_customer_last_30_days",
    "text": "What is the total repeat customer for the last 30 days?",
    "pseudo_sql": "SELECT COUNT(*) FROM orderitems oi",
    "metadata": {
      "topic": "customer",
      "subtopic": "segmentation",
      "logic_id": "repeat_customer",
      "variant": 1
    }
  },
  {
    "id": "logic_repeat_customer_monthly_2025",
    "text": "Show me repeat customer broken down by month for 2025.",
    "pseudo_sql": "SELECT COUNT(*) FROM orderitems oi",
    "metadata": {
      "topic": "customer",
      "subtopic": "segmentation",
      "logic_id": "repeat_customer",
      "variant": 2
    }
  },
  {
    "id": "logic_repeat_customer_by_category",
    "text": "Which product category has the highest repeat customer?",
    "pseudo_sql": "SELECT COUNT(*) FROM orderitems oi",
    "metadata": {
      "topic": "customer",
      "subtopic": "segmentation",
      "logic_id": "repeat_customer",
      "variant": 3
    }
  },
  {
    "id": "logic_repeat_customer_wow_comparison",
    "text": "What was the repeat customer for yesterday compared to the same day last week?",
    "pseudo_sql": "SELECT COUNT(*) FROM orderitems oi",
    "metadata": {
      "topic": "customer",
      "subtopic": "segmentation",
      "logic_id": "repeat_customer",
      "variant": 4
    }
  },
  {
    "id": "logic_repeat_customer_top_5_ytd",
    "text": "Show top 5 repeat customer contributors for the current year.",
    "pseudo_sql": "SELECT COUNT(*) FROM orderitems oi",
    "metadata": {
      "topic": "customer",
      "subtopic": "segmentation",
      "logic_id": "repeat_customer",
      "variant": 5
    }
  },
  {
    "id": "logic_primary_vs_addon_last_30_days",
    "text": "What is the total primary vs addon for the last 30 days?",
    "pseudo_sql": "SELECT COUNT(*) FROM orderitems oi",
    "metadata": {
      "topic": "product",
      "subtopic": "merchandising",
      "logic_id": "primary_vs_addon",
      "variant": 1
    }
  },
  {
    "id": "logic_primary_vs_addon_monthly_2025",
    "text": "Show me primary vs addon broken down by month for 2025.",
    "pseudo_sql": "SELECT COUNT(*) FROM orderitems oi",
    "metadata": {
      "topic": "product",
      "subtopic": "merchandising",
      "logic_id": "primary_vs_addon",
      "variant": 2
    }
  },
  {
    "id": "logic_primary_vs_addon_by_category",
    "text": "Which product category has the highest primary vs addon?",
    "pseudo_sql": "SELECT COUNT(*) FROM orderitems oi",
    "metadata": {
      "topic": "product",
      "subtopic": "merchandising",
      "logic_id": "primary_vs_addon",
      "variant": 3
    }
  },
  {
    "id": "logic_primary_vs_addon_wow_comparison",
    "text": "What was the primary vs addon for yesterday compared to the same day last week?",
    "pseudo_sql": "SELECT COUNT(*) FROM orderitems oi",
    "metadata": {
      "topic": "product",
      "subtopic": "merchandising",
      "logic_id": "primary_vs_addon",
      "variant": 4
    }
  },
  {
    "id": "logic_primary_vs_addon_top_5_ytd",
    "text": "Show top 5 primary vs addon contributors for the current year.",
    "pseudo_sql": "SELECT COUNT(*) FROM orderitems oi",
    "metadata": {
      "topic": "product",
      "subtopic": "merchandising",
      "logic_id": "primary_vs_addon",
      "variant": 5
    }
  },
  {
    "id": "logic_best_sellers_last_30_days",
    "text": "What is the total best sellers for the last 30 days?",
    "pseudo_sql": "SELECT COUNT(*) FROM orderitems oi",
    "metadata": {
      "topic": "product",
      "subtopic": "performance",
      "logic_id": "best_sellers",
      "variant": 1
    }
  },
  {
    "id": "logic_best_sellers_monthly_2025",
    "text": "Show me best sellers broken down by month for 2025.",
    "pseudo_sql": "SELECT COUNT(*) FROM orderitems oi",
    "metadata": {
      "topic": "product",
      "subtopic": "performance",
      "logic_id": "best_sellers",
      "variant": 2
    }
  },
  {
    "id": "logic_best_sellers_by_category",
    "text": "Which product category has the highest best sellers?",
    "pseudo_sql": "SELECT COUNT(*) FROM orderitems oi",
    "metadata": {
      "topic": "product",
      "subtopic": "performance",
      "logic_id": "best_sellers",
      "variant": 3
    }
  },
  {
    "id": "logic_best_sellers_wow_comparison",
    "text": "What was the best sellers for yesterday compared to the same day last week?",
    "pseudo_sql": "SELECT COUNT(*) FROM orderitems oi",
    "metadata": {
      "topic": "product",
      "subtopic": "performance",
      "logic_id": "best_sellers",
      "variant": 4
    }
  },
  {
    "id": "logic_best_sellers_top_5_ytd",
    "text": "Show top 5 best sellers contributors for the current year.",
    "pseudo_sql": "SELECT COUNT(*) FROM orderitems oi",
    "metadata": {
      "topic": "product",
      "subtopic": "performance",
      "logic_id": "best_sellers",
      "variant": 5
    }
  },
  {
    "id": "logic_canonical_joins_last_30_days",
    "text": "What is the total canonical joins for the last 30 days?",
    "pseudo_sql": "SELECT COUNT(*) FROM orderitems oi",
    "metadata": {
      "topic": "dataengineering",
      "subtopic": "joins",
      "logic_id": "canonical_joins",
      "variant": 1
    }
  },
  {
    "id": "logic_canonical_joins_monthly_2025",
    "text": "Show me canonical joins broken down by month for 2025.",
    "pseudo_sql": "SELECT COUNT(*) FROM orderitems oi",
    "metadata": {
      "topic": "dataengineering",
      "subtopic": "joins",
      "logic_id": "canonical_joins",
      "variant": 2
    }
  },
  {
    "id": "logic_canonical_joins_by_category",
    "text": "Which product category has the highest canonical joins?",
    "pseudo_sql": "SELECT COUNT(*) FROM orderitems oi",
    "metadata": {
      "topic": "dataengineering",
      "subtopic": "joins",
      "logic_id": "canonical_joins",
      "variant": 3
    }
  },
  {
    "id": "logic_canonical_joins_wow_comparison",
    "text": "What was the canonical joins for yesterday compared to the same day last week?",
    "pseudo_sql": "SELECT COUNT(*) FROM orderitems oi",
    "metadata": {
      "topic": "dataengineering",
      "subtopic": "joins",
      "logic_id": "canonical_joins",
      "variant": 4
    }
  },
  {
    "id": "logic_canonical_joins_top_5_ytd",
    "text": "Show top 5 canonical joins contributors for the current year.",
    "pseudo_sql": "SELECT COUNT(*) FROM orderitems oi",
    "metadata": {
      "topic": "dataengineering",
      "subtopic": "joins",
      "logic_id": "canonical_joins",
      "variant": 5
    }
  },
  {
    "id": "logic_aov_last_30_days",
    "text": "What is the total aov for the last 30 days?",
    "pseudo_sql": "SELECT AVG(net_rev) FROM (SELECT o.orderid, SUM(oi.priceusd - COALESCE(r.refund, 0)) as net_rev FROM orders o JOIN orderitems oi ON o.orderid = oi.orderid LEFT JOIN (SELECT orderitemid, SUM(refundamountusd) as refund FROM refunds GROUP BY 1) r ON oi.orderitemid = r.orderitemid GROUP BY 1 HAVING net_rev > 0) t",
    "metadata": {
      "topic": "finance",
      "subtopic": "aov",
      "logic_id": "aov",
      "variant": 1
    }
  },
  {
    "id": "logic_aov_monthly_2025",
    "text": "Show me aov broken down by month for 2025.",
    "pseudo_sql": "SELECT AVG(net_rev) FROM (SELECT o.orderid, SUM(oi.priceusd - COALESCE(r.refund, 0)) as net_rev FROM orders o JOIN orderitems oi ON o.orderid = oi.orderid LEFT JOIN (SELECT orderitemid, SUM(refundamountusd) as refund FROM refunds GROUP BY 1) r ON oi.orderitemid = r.orderitemid GROUP BY 1 HAVING net_rev > 0) t",
    "metadata": {
      "topic": "finance",
      "subtopic": "aov",
      "logic_id": "aov",
      "variant": 2
    }
  },
  {
    "id": "logic_aov_by_category",
    "text": "Which product category has the highest aov?",
    "pseudo_sql": "SELECT AVG(net_rev) FROM (SELECT o.orderid, SUM(oi.priceusd - COALESCE(r.refund, 0)) as net_rev FROM orders o JOIN orderitems oi ON o.orderid = oi.orderid LEFT JOIN (SELECT orderitemid, SUM(refundamountusd) as refund FROM refunds GROUP BY 1) r ON oi.orderitemid = r.orderitemid GROUP BY 1 HAVING net_rev > 0) t",
    "metadata": {
      "topic": "finance",
      "subtopic": "aov",
      "logic_id": "aov",
      "variant": 3
    }
  },
  {
    "id": "logic_aov_wow_comparison",
    "text": "What was the aov for yesterday compared to the same day last week?",
    "pseudo_sql": "SELECT AVG(net_rev) FROM (SELECT o.orderid, SUM(oi.priceusd - COALESCE(r.refund, 0)) as net_rev FROM orders o JOIN orderitems oi ON o.orderid = oi.orderid LEFT JOIN (SELECT orderitemid, SUM(refundamountusd) as refund FROM refunds GROUP BY 1) r ON oi.orderitemid = r.orderitemid GROUP BY 1 HAVING net_rev > 0) t",
    "metadata": {
      "topic": "finance",
      "subtopic": "aov",
      "logic_id": "aov",
      "variant": 4
    }
  },
  {
    "id": "logic_aov_top_5_ytd",
    "text": "Show top 5 aov contributors for the current year.",
    "pseudo_sql": "SELECT AVG(net_rev) FROM (SELECT o.orderid, SUM(oi.priceusd - COALESCE(r.refund, 0)) as net_rev FROM orders o JOIN orderitems oi ON o.orderid = oi.orderid LEFT JOIN (SELECT orderitemid, SUM(refundamountusd) as refund FROM refunds GROUP BY 1) r ON oi.orderitemid = r.orderitemid GROUP BY 1 HAVING net_rev > 0) t",
    "metadata": {
      "topic": "finance",
      "subtopic": "aov",
      "logic_id": "aov",
      "variant": 5
    }
  },
  {
    "id": "logic_refund_rate_last_30_days",
    "text": "What is the total refund rate for the last 30 days?",
    "pseudo_sql": "SELECT COUNT(*) FROM orderitems oi",
    "metadata": {
      "topic": "quality",
      "subtopic": "refundrate",
      "logic_id": "refund_rate",
      "variant": 1
    }
  },
  {
    "id": "logic_refund_rate_monthly_2025",
    "text": "Show me refund rate broken down by month for 2025.",
    "pseudo_sql": "SELECT COUNT(*) FROM orderitems oi",
    "metadata": {
      "topic": "quality",
      "subtopic": "refundrate",
      "logic_id": "refund_rate",
      "variant": 2
    }
  },
  {
    "id": "logic_refund_rate_by_category",
    "text": "Which product category has the highest refund rate?",
    "pseudo_sql": "SELECT COUNT(*) FROM orderitems oi",
    "metadata": {
      "topic": "quality",
      "subtopic": "refundrate",
      "logic_id": "refund_rate",
      "variant": 3
    }
  },
  {
    "id": "logic_refund_rate_wow_comparison",
    "text": "What was the refund rate for yesterday compared to the same day last week?",
    "pseudo_sql": "SELECT COUNT(*) FROM orderitems oi",
    "metadata": {
      "topic": "quality",
      "subtopic": "refundrate",
      "logic_id": "refund_rate",
      "variant": 4
    }
  },
  {
    "id": "logic_refund_rate_top_5_ytd",
    "text": "Show top 5 refund rate contributors for the current year.",
    "pseudo_sql": "SELECT COUNT(*) FROM orderitems oi",
    "metadata": {
      "topic": "quality",
      "subtopic": "refundrate",
      "logic_id": "refund_rate",
      "variant": 5
    }
  },
  {
    "id": "logic_time_utc_last_30_days",
    "text": "What is the total time utc for the last 30 days?",
    "pseudo_sql": "SELECT COUNT(*) FROM orderitems oi",
    "metadata": {
      "topic": "timelogic",
      "subtopic": "filtering",
      "logic_id": "time_utc",
      "variant": 1
    }
  },
  {
    "id": "logic_time_utc_monthly_2025",
    "text": "Show me time utc broken down by month for 2025.",
    "pseudo_sql": "SELECT COUNT(*) FROM orderitems oi",
    "metadata": {
      "topic": "timelogic",
      "subtopic": "filtering",
      "logic_id": "time_utc",
      "variant": 2
    }
  },
  {
    "id": "logic_time_utc_by_category",
    "text": "Which product category has the highest time utc?",
    "pseudo_sql": "SELECT COUNT(*) FROM orderitems oi",
    "metadata": {
      "topic": "timelogic",
      "subtopic": "filtering",
      "logic_id": "time_utc",
      "variant": 3
    }
  },
  {
    "id": "logic_time_utc_wow_comparison",
    "text": "What was the time utc for yesterday compared to the same day last week?",
    "pseudo_sql": "SELECT COUNT(*) FROM orderitems oi",
    "metadata": {
      "topic": "timelogic",
      "subtopic": "filtering",
      "logic_id": "time_utc",
      "variant": 4
    }
  },
  {
    "id": "logic_time_utc_top_5_ytd",
    "text": "Show top 5 time utc contributors for the current year.",
    "pseudo_sql": "SELECT COUNT(*) FROM orderitems oi",
    "metadata": {
      "topic": "timelogic",
      "subtopic": "filtering",
      "logic_id": "time_utc",
      "variant": 5
    }
  },
  {
    "id": "logic_partial_refunds_last_30_days",
    "text": "What is the total partial refunds for the last 30 days?",
    "pseudo_sql": "SELECT COUNT(*) FROM orderitems oi",
    "metadata": {
      "topic": "finance",
      "subtopic": "refunds",
      "logic_id": "partial_refunds",
      "variant": 1
    }
  },
  {
    "id": "logic_partial_refunds_monthly_2025",
    "text": "Show me partial refunds broken down by month for 2025.",
    "pseudo_sql": "SELECT COUNT(*) FROM orderitems oi",
    "metadata": {
      "topic": "finance",
      "subtopic": "refunds",
      "logic_id": "partial_refunds",
      "variant": 2
    }
  },
  {
    "id": "logic_partial_refunds_by_category",
    "text": "Which product category has the highest partial refunds?",
    "pseudo_sql": "SELECT COUNT(*) FROM orderitems oi",
    "metadata": {
      "topic": "finance",
      "subtopic": "refunds",
      "logic_id": "partial_refunds",
      "variant": 3
    }
  },
  {
    "id": "logic_partial_refunds_wow_comparison",
    "text": "What was the partial refunds for yesterday compared to the same day last week?",
    "pseudo_sql": "SELECT COUNT(*) FROM orderitems oi",
    "metadata": {
      "topic": "finance",
      "subtopic": "refunds",
      "logic_id": "partial_refunds",
      "variant": 4
    }
  },
  {
    "id": "logic_partial_refunds_top_5_ytd",
    "text": "Show top 5 partial refunds contributors for the current year.",
    "pseudo_sql": "SELECT COUNT(*) FROM orderitems oi",
    "metadata": {
      "topic": "finance",
      "subtopic": "refunds",
      "logic_id": "partial_refunds",
      "variant": 5
    }
  },
  {
    "id": "logic_product_identity_last_30_days",
    "text": "What is the total product identity for the last 30 days?",
    "pseudo_sql": "SELECT COUNT(*) FROM orderitems oi",
    "metadata": {
      "topic": "product",
      "subtopic": "identity",
      "logic_id": "product_identity",
      "variant": 1
    }
  },
  {
    "id": "logic_product_identity_monthly_2025",
    "text": "Show me product identity broken down by month for 2025.",
    "pseudo_sql": "SELECT COUNT(*) FROM orderitems oi",
    "metadata": {
      "topic": "product",
      "subtopic": "identity",
      "logic_id": "product_identity",
      "variant": 2
    }
  },
  {
    "id": "logic_product_identity_by_category",
    "text": "Which product category has the highest product identity?",
    "pseudo_sql": "SELECT COUNT(*) FROM orderitems oi",
    "metadata": {
      "topic": "product",
      "subtopic": "identity",
      "logic_id": "product_identity",
      "variant": 3
    }
  },
  {
    "id": "logic_product_identity_wow_comparison",
    "text": "What was the product identity for yesterday compared to the same day last week?",
    "pseudo_sql": "SELECT COUNT(*) FROM orderitems oi",
    "metadata": {
      "topic": "product",
      "subtopic": "identity",
      "logic_id": "product_identity",
      "variant": 4
    }
  },
  {
    "id": "logic_product_identity_top_5_ytd",
    "text": "Show top 5 product identity contributors for the current year.",
    "pseudo_sql": "SELECT COUNT(*) FROM orderitems oi",
    "metadata": {
      "topic": "product",
      "subtopic": "identity",
      "logic_id": "product_identity",
      "variant": 5
    }
  }
]